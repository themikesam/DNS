<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="用於暨大計網中心諮詢組電腦教室可以快速諮詢用">
    <meta name="keywords" content="計中,諮詢組,暨南大學">
    <meta name="author" content="themikesam">
    <link href="https://sgs.student.ncnu.edu.tw/templates/jsn_megazine_pro/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">
    <title>計網中心 — 諮詢組</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
        integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.css"> -->

    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
        integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous">
    </script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
        integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous">
    </script>
    <style>
        body {
            position: relative;
        }

        #disable {
            position: absolute;
            /* left: 50%;
        top: 50%; */
            height: 100vh;
            width: 100vw;
            background-color: rgba(255, 255, 255, 0.7);
            z-index: 99;
        }

        #loading {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 100;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .card {
            margin-bottom: 20px;
        }

        .card-link {
            font-size: 18pt;
        }

        @media screen and (max-width: 768px) {
            .container {
                width: 100%;
                padding: 0px
            }

            .row>div {
                padding: 0px;
                padding-left: 5px;
            }
            .list-group {
                text-align: center;
            }
            .list-group-item {
                padding: .5rem .5rem;
                text-align: center;
            }
            .list-group-item-action {
                width: 85%;
            }
            /* *, ::after, ::before {
                box-sizing: none;
            }    */
        }
    </style>
</head>

<body>
    <div id="disable"></div>
    <div id='loading'></div>
    <div class="container">
        <h1 id="title" style="height:100%;" align="center">計網中心</h1>
        <div class="row">
            <div class="col-lg-4 col-md-2 col-4">
                <div id="list-example" class="list-group">
                    <a class="list-group-item list-group-item-action" href="#list-item-1">聯繫方式</a>
                    <a class="list-group-item list-group-item-action" href="#list-item-2">如何列印</a>
                    <a class="list-group-item list-group-item-action" href="#list-item-3">其他問題</a>
                    <a class="list-group-item list-group-item-action" href="#list-item-4">登錄帳密</a>
                </div>
            </div>
            <div class="col-lg-8 col-md-10 col-8">
                <div data-spy="scroll" data-target="#title" data-offset="10" class="scrollspy-example" style="height:80vh;overflow-y:scroll;overflow: auto;
                    -webkit-overflow-scrolling: touch;">
                    <div id="list-item-1" class="card">
                        <div class="card-header">
                            聯繫方式
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="contact"></h5>
                            <p class="card-text">請點擊以下方式聯繫</p>
                            <b id="notice">P/S：若電話無法撥通，或許是訊號不佳所致，可嘗試使用FB私訊聯繫</b>
                            <a href="#" id="call_link" class="card-link"><span id="call"
                                    class="badge badge-success"></span></a><br/>
                            <a href="#" id="messenger_link" class="card-link"><span id="messenger"
                                    class="badge badge-primary"></span></a>

                        </div>
                    </div>
                    <div id="list-item-2" class="card">
                        <div class="card-header">
                            如何列印？
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">步驟如下：</h5>
                            <ol>
                                　<li>新增印表機</li>
                                <ul>
                                    <li><kbd>Windows鍵</kbd> + <kbd>R鍵</kbd></li>
                                    <li>在彈出的輸入框內輸入 <kbd>\\cnprint</kbd></li>
                                    <li><kbd>Enter鍵</kbd></li>
                                </ul>
                                　<li>
                                    選擇對應的印表機
                                    <table class="table table-hover table-bordered">
                                        <thead class="thead-dark">
                                            <th>
                                                印表機
                                            </th>
                                            <th>
                                                電腦教室</th>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    圖資028黑白
                                                </td>
                                                <td>
                                                    圖資028</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    圖資028彩色
                                                </td>
                                                <td>
                                                    圖資028</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    圖資027黑白
                                                </td>
                                                <td>
                                                    圖資027</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    教A101黑白
                                                </td>
                                                <td>
                                                    教院A101</td>
                                            </tr>
                                        </tbody>

                                    </table>
                                </li>
                                <li>
                                    失敗原因：
                                    <ul>
                                        <li>餘額不足（可至<kbd>行政大樓</kbd>或<kbd>圖資大樓</kbd>一樓透過<kbd>自動繳費機</kbd>加額。</li>
                                        <li>未選擇對應的印表機</li>
                                        <li>檔案規格有問題（常見的有PDF，可嘗試<kbd>複製 / 儲存</kbd>到桌面再嘗試）</li>
                                        <li>印表機紙張不足</li>
                                    </ul>
                                </li>
                                <li>
                                    可退費因素：
                                    <ul>
                                        <li>碳粉不足導致列印失敗</li>
                                        <li>技術性問題</li>
                                    </ul>

                                </li>
                            </ol>
                        </div>
                    </div>
                    <div id="list-item-3" class="card">
                        <div class="card-header">
                            其他問題
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">電腦課室借用</h5>
                            <p class="card-text">請填寫表格後送至計網中心1F諮詢組
                            </p>
                        </div>
                    </div>
                    <div id="list-item-4" class="card">
                        <div class="card-header">
                            登錄帳密
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">以CN網域賬戶登錄</h5>
                            <ol>
                                <li>
                                    <h4><span class="badge badge-warning">CN網域</span></h4>
                                    <p>預設帳號：學號</p>
                                    <p>預設密碼：身份證（僑生為民國生日）</p>
                                    <span class="label label-warning">用途：登錄電腦教室電腦</span>
                                </li>
                                <li>
                                    <h4><span class="badge badge-danger">Email</span></h4>
                                    <p>預設帳號：s學號@ncnu.edu.tw (自動轉寄至s學號@mail1.ncnu.edu.tw)</p>
                                    <p>預設密碼：身份證（僑生為民國生日）</p>
                                    <span class="label label-danger">用途：收信、寄信、mail1則屬谷歌服務</span>
                                </li>
                                <li>
                                    <h4><span class="badge badge-success">教務系統</span></h4>
                                    <p>預設帳號：學號</p>
                                    <p>預設密碼：身份證（僑生為民國生日）</p>
                                    <span class="label label-success">用途：如題，教務系統功能，最常見為選課</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                    <div style="height:200px;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
        integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous">
    </script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
        integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous">
    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js">
    </script>
    <script>
        var mytable;
        var national = [];
        var continent = [];
        var item = '';
        var tel = "tel:";

        function addData(count, post) {
            // post.photo // post.job // post.name // post.phone // post.email // post.service

            if (post.name != "") {
                item = '';
                item +=
                    '<tr><td width="20%"><img style="max-width:15vw;vertical-align:middle;" src="' + post.photo +
                    '"/></td><td width="80%"><h1 style="text-align:left;">' + post.job + ' - ' + post.name +
                    '</h1><p style="text-align:left;">分機：<a href="tel:0492910960;' + post.phone + '">' + post.phone +
                    '</a><br/>E-mail：<a href="mailto:' + post.email + '@ncnu.edu.tw">' + post.email +
                    '@ncnu.edu.tw</a><br/>業務職掌：<br/>' + (post.service).replace(/\n/g, "<br />") + '</p></td></tr>';
                $('#member').append(item);
            }
        }

        function getPosts() {
            $.ajax({
                // url: "https://script.google.com/macros/s/AKfycbzPQUpzI2tMbT3A-00vPAzQaA12xggqEWHPGdhdRIpTX0PZpXS5/exec",
                url: "https://script.googleusercontent.com/macros/echo?user_content_key=SDwQg75JN_c4_QqHRw-Iu1tU__CVriPnrsfHvfAOnrb58CtuHP6eZWNtDXyJIo7EAus0x8BClN5HY7gfNcwPv14RVkcmb1tXm5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnEx8L9hwqiQFpMlKSxJtr7BMqmdNZEymAbBTTP5CFsMstci2Zmr-CTSGjKNfkF0GstlJkWbb1CEk&lib=MazX_843qJe7GwfaicSASgYozVCALV5Db",
                dataType: 'json',
                beforeSend: function () {
                    // Show image container
                    $("#disable").show();
                    $("#loading").show();
                    $("#notice").hide();
                },
                success: function (data) {
                    var call = '';
                    var d = new Date();
                    var currHour = d.getHours();
                    var currDay = d.getDay();
                    var day;
                    var pointer;
                    var duty = ['0800-0900', '0900-1200', '1300-1700', '1700-2100'];

                    if (currHour <= 7) { //8點前，前一天
                        pointer = 3;
                        currDay--;
                    } else if (currHour <= 8) { //9點前，當天
                        pointer = 0;
                    } else if (currHour <= 11) { //12點前，當天
                        pointer = 1;
                    } else if (currHour <= 16) { //17點前，當天
                        pointer = 2;
                    } else { // 當天
                        pointer = 3;
                    }

                    switch (currDay) {
                        case 0:
                            day = '星期日';
                            break;
                        case 1:
                            day = '星期一';
                            break;
                        case 2:
                            day = '星期二';
                            break;
                        case 3:
                            day = '星期三';
                            break;
                        case 4:
                            day = '星期四';
                            break;
                        case 5:
                            day = '星期五';
                            break;
                        case 6:
                            day = '星期六';
                        case 7:
                            day = '星期日';
                            break;
                        case -1:
                            day = '星期六';
                            break;
                    }

                    console.log(data);
                    console.log('---現在---星期：' + currDay + '時段：' + currHour);
                    // console.log(currDay);
                    // console.log(currHour);
                    var tester = data.duty[day][0][duty[pointer]];
                    console.log(tester);
                    console.log(data.details[0][tester].Tel);
                    console.log(data.details[0][tester].Messenger);
                    call = (data.details[0][tester].Tel);
                    console.log(call);
                    tel += call;
                    console.log(tel);
                    if (currDay == 0 || currDay == -1 || currDay == 7 || currDay == 6 || pointer != 1 ||
                        pointer != 2) {
                        $("#notice").show();
                        $('#contact').html('工讀生：' + tester);
                        $('#call').text('撥打：' + data.details[0][tester].Tel);
                        $("#call_link").attr("href", "tel:" + data.details[0][tester].Tel);
                        $('#messenger').text('透過 FB 私訊');
                        $("#messenger_link").attr("href", "https://m.me/" + data.details[0][tester]
                            .Messenger);
                    } else {
                        $('#contact').html(tester);
                        $('#call').text('撥打：' + data.details[0][tester].Tel);
                        $("#call_link").attr("href", "tel" + data.details[0][tester].Tel);
                        $('#messenger').text('');
                        $("#messenger_link").attr("href", "#");
                    }
                    // window.location.href = tel;
                    // console.log(data);
                    // var test = data.calls[0];
                    // console.log(data.calls[0][1]);
                    // console.log(data.details[0][1]);
                    // console.log(test[1]);
                    // for (var i = 0; i < data.user.length; i++) {
                    //     addData(i,data.user[i]);
                    // }
                },
                error: function (e) {
                    console.log(e.message);
                    // alert('抓取失敗');
                },
                complete: function (data) {
                    $("#disable").hide(500);
                    $("#loading").hide(1000);
                }
            });
        }
        $(document).ready(function () {
            getPosts();
        });
    </script>
</body>

</html>
